CREATE DATABASE 'localhost/3050:C:\CAMINHO_BASE\DADOS_FORTES.FDB'
  USER 'SYSDBA'
  PAGE_SIZE = 4096
  DEFAULT CHARACTER SET WIN1252
  COLLATION WIN1252;

CREATE TABLE TANQUE (ID INTEGER NOT NULL CONSTRAINT PK_TANQUE PRIMARY KEY,
ST_COMBUSTIVEL SMALLINT);

CREATE TABLE BOMBA(ID INTEGER NOT NULL CONSTRAINT PK_BOMBA PRIMARY KEY,
ID_TANQUE INTEGER NOT NULL);

ALTER TABLE BOMBA ADD CONSTRAINT FK_BOMBA_TANQUE FOREIGN KEY(ID_TANQUE) REFERENCES TANQUE(ID);

CREATE TABLE ABASTECIMENTO(ID INTEGER NOT NULL CONSTRAINT PK_ABASTECIMENTO PRIMARY KEY,
ID_BOMBA INTEGER NOT NULL,
DH_ABASTECIMENTO TIMESTAMP,
QT_LITROS NUMERIC(18,4),
VL_UNITARIO NUMERIC(18,3),
VL_TOTAL NUMERIC(18,2),
VL_IMPOSTO NUMERIC(18,2));

ALTER TABLE ABASTECIMENTO ADD CONSTRAINT FK_ABASTECIMENTO_BOMBA FOREIGN KEY(ID_BOMBA) REFERENCES BOMBA(ID);


CREATE GENERATOR ABASTECIMENTO_ID_GEN;

SET TERM ^ ;

CREATE TRIGGER BI_ABASTECIMENTO_ID FOR ABASTECIMENTO
ACTIVE BEFORE 
  INSERT
POSITION 0
AS
BEGIN
  NEW.ID = GEN_ID(ABASTECIMENTO_ID_GEN, 1);
END^

SET TERM ; ^


CREATE GENERATOR BOMBA_ID_GEN;


SET TERM ^ ;

CREATE TRIGGER BI_BOMBA_ID FOR BOMBA
ACTIVE BEFORE 
  INSERT
POSITION 0
AS
BEGIN
  NEW.ID = GEN_ID(BOMBA_ID_GEN, 1);
END^

SET TERM ; ^


CREATE GENERATOR TANQUE_ID_GEN;


SET TERM ^ ;

CREATE TRIGGER BI_TANQUE_ID FOR TANQUE
ACTIVE BEFORE 
  INSERT
POSITION 0
AS
BEGIN
  NEW.ID = GEN_ID(TANQUE_ID_GEN, 1);
END^

SET TERM ; ^


INSERT INTO TANQUE VALUES (1, 0);
INSERT INTO TANQUE VALUES (2, 1);

COMMIT WORK;


INSERT INTO BOMBA VALUES (1, 1);
INSERT INTO BOMBA VALUES (2, 1);
INSERT INTO BOMBA VALUES (3, 2);
INSERT INTO BOMBA VALUES (4, 2);

COMMIT WORK;
